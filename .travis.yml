language: php
php:
 - "5.4"
 - "5.5"
 - "hhvm"
 - "7"
env:
 - YENTU_DRIVER=mysql YENTU_HOST=localhost YENTU_USER=root YENTU_BASE_DSN='mysql:host=localhost'
 - YENTU_DRIVER=postgresql YENTU_HOST=localhost YENTU_USER=postgres YENTU_DEFAULT_SCHEMA=public YENTU_BASE_DSN='mysql:host=localhost'
before_script: 
 - composer install --prefer-dist
 
matrix:
 allow_failures:
  - php: "7"
 include:
  - php: "5.6"
    env: YENTU_DRIVER=mysql YENTU_HOST=localhost YENTU_USER=root YENTU_BASE_DSN='mysql:host=localhost' COVERAGE=yes
  - php: "5.6"
    env: YENTU_DRIVER=postgresql YENTU_HOST=localhost YENTU_USER=postgres YENTU_DEFAULT_SCHEMA=public YENTU_BASE_DSN='mysql:host=localhost' COVERAGE=yes
 exclude:
  - php: "hhvm"
    env: ATIAA_DRIVER=postgresql ATIAA_HOST=localhost ATIAA_USER=postgres ATIAA_DBNAME=atiaa_test ATIAA_HAS_SCHEMAS=yes ATIAA_PDO_DSN='pgsql:host=localhost;dbname=atiaa_test;user=postgres'

 
services:
 - postgresql
 - mysql

script: vendor/bin/phpunit --coverage-clover coverage.clover --configuration tests/config/travis.xml
after_script: if [ "$COVERAGE" == "yes" ]; then wget https://scrutinizer-ci.com/ocular.phar && php ocular.phar code-coverage:upload --access-token="93e209791d440d1069195255daaa32ce84f96e88ced6d40490b1352dca34f96c" --format=php-clover coverage.clover fi
